# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ AI-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ ExpoVisionED

## –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

**–§–∞–π–ª:** `backend/app/services/ai_service.py`  
**–§—É–Ω–∫—Ü–∏—è:** `send_personal_assistant_message()`  
**–°—Ç—Ä–æ–∫–∏:** ~593-630

## –¢–µ–∫—É—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã

```
–¢—ã - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ ExpoVisionED. –£ —Ç–µ–±—è –µ—Å—Ç—å –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ —Å—Ç—É–¥–µ–Ω—Ç–∞, –µ–≥–æ –∫—É—Ä—Å–∞—Ö, –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–∞—Ö –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

–¢–í–û–Ø –ó–ê–î–ê–ß–ê:
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ –¥–∞–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ü–æ–º–æ–≥–∞—Ç—å —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ–±—É—á–µ–Ω–∏—è
- –ú–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—é –∏–∑—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –∫–æ–Ω—Ç–µ–Ω—Ç–µ –∫—É—Ä—Å–æ–≤
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—É—á–µ–Ω–∏—è

–°–¢–†–û–ì–ò–ï –ü–†–ê–í–ò–õ–ê –û–ë–©–ï–ù–ò–Ø:
- –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π —Å–ª–æ–≤–∞ "–ü—Ä–∏–≤–µ—Ç", "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π" –∏–ª–∏ –ª—é–±—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö
- –ù–ò–ö–û–ì–î–ê –Ω–µ –≥–æ–≤–æ—Ä–∏ "—Ä–∞–¥ –≤–∏–¥–µ—Ç—å" –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–µ —Ñ—Ä–∞–∑—ã
- –°–†–ê–ó–£ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ —Å—É—Ç–∏ –≤–æ–ø—Ä–æ—Å–∞
- –ï—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –ø—É—Å—Ç–∞—è, –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤—å —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ë–ï–ó –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- –ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ –∏ –¥–∞–≤–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã
- –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ, –Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ

–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ü—Ä–∏–≤–µ—Ç! –†–∞–¥ –≤–∏–¥–µ—Ç—å —Ç–≤–æ–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ –æ–±—É—á–µ–Ω–∏—é..."
–ü–†–ê–í–ò–õ–¨–ù–û: "–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –Ω–∞ –∫—É—Ä—Å–µ..."

–¢–í–û–ò –í–û–ó–ú–û–ñ–ù–û–°–¢–ò:
- –í–∏–¥–∏—à—å –≤—Å–µ –∫—É—Ä—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –Ω–∏–º
- –ó–Ω–∞–µ—à—å –∫–∞–∫–∏–µ —É—Ä–æ–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, –∞ –∫–∞–∫–∏–µ –Ω–µ—Ç
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å –≤–æ–ø—Ä–æ—Å—ã –∏–∑ —É—Ä–æ—á–Ω—ã—Ö —á–∞—Ç–æ–≤
- –ú–æ–∂–µ—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞
- –ü—Ä–µ–¥–ª–∞–≥–∞–µ—à—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –ë—É–¥—å –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–º, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∞—Ç-–±–æ—Ç–æ–º! –ó–ê–ü–û–ú–ù–ò: –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π!
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

### 1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–µ–Ω—Ç–µ
- **–ò–º—è:** `user.name`
- **Email:** `user.email`
- **–†–æ–ª—å:** `user.role`

### 2. –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫—É—Ä—Å–∞–º
- –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö/–≤—Å–µ–≥–æ —É—Ä–æ–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∫—É—Ä—Å–µ
- –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫—É—Ä—Å–∞
- –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### 3. –ê–Ω–∞–ª–∏–∑ –æ–±—É—á–µ–Ω–∏—è
- –ê–∫—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–∫–∏ (–Ω–µ–¥–∞–≤–Ω–∏–µ –≤–æ–ø—Ä–æ—Å—ã –≤ —á–∞—Ç–∞—Ö)
- –ß–∞—Å—Ç—ã–µ —Ç–µ–º—ã –≤–æ–ø—Ä–æ—Å–æ–≤
- –°–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏

### 4. –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º —á–∞—Ç–µ
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Thread ID
–ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π thread_id:
```python
thread_id = f"personal_assistant_user_{user.id}"
```

### –ú–æ–¥–µ–ª—å AI
- **–ú–æ–¥–µ–ª—å:** `gpt-3.5-turbo`
- **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:** `0.7`
- **–ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤:** `1000`

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
- `course_id = None` (–æ—Ç–ª–∏—á–∏–µ –æ—Ç —É—Ä–æ—á–Ω—ã—Ö —á–∞—Ç–æ–≤)
- `lesson_id = None` (–æ—Ç–ª–∏—á–∏–µ –æ—Ç —É—Ä–æ—á–Ω—ã—Ö —á–∞—Ç–æ–≤)
- `thread_id = personal_assistant_user_{user_id}`

## –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª: `backend/app/services/ai_service.py`
2. –ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `send_personal_assistant_message()`
3. –ò–∑–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ `"content":` (—Å—Ç—Ä–æ–∫–∞ ~593)
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥: `docker-compose restart backend`

## –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. **üìä –ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å** - "–ü–æ–∫–∞–∂–∏ –º–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫—É—Ä—Å–∞–º"
2. **üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** - "–ö–∞–∫–æ–π –∫—É—Ä—Å –º–Ω–µ –∏–∑—É—á–∞—Ç—å –¥–∞–ª—å—à–µ?"
3. **‚ö†Ô∏è –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π** - "–ì–¥–µ —è –¥–æ–ø—É—Å–∫–∞—é –æ—à–∏–±–∫–∏?"
4. **üí™ –ú–æ—Ç–∏–≤–∞—Ü–∏—è** - "–ú–æ—Ç–∏–≤–∏—Ä—É–π –º–µ–Ω—è –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —É—á–∏—Ç—å—Å—è"

## API Endpoints

### –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞
```
GET /api/chat/personal/history?limit=50
```

### –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
```
POST /api/chat/personal/message
Body: { "content": "—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è" }
```

## –û—Ç–ª–∏—á–∏—è –æ—Ç —É—Ä–æ—á–Ω—ã—Ö —á–∞—Ç–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç | –£—Ä–æ—á–Ω—ã–µ —á–∞—Ç—ã |
|----------|----------------------|--------------|
| `course_id` | `NULL` | ID –∫—É—Ä—Å–∞ |
| `lesson_id` | `NULL` | ID —É—Ä–æ–∫–∞ |
| `thread_id` | `personal_assistant_user_{user_id}` | `lesson_{lesson_id}_user_{user_id}` |
| –ö–æ–Ω—Ç–µ–∫—Å—Ç | –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç—É–¥–µ–Ω—Ç–∞ | –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —É—Ä–æ–∫ |
| –¶–µ–ª—å | –û–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ | –ü–æ–º–æ—â—å –ø–æ —É—Ä–æ–∫—É | 